---
import BaseLayout from '../../layouts/BaseLayout.astro';
import type {postType} from '../../util/interface.tsx'; 
export async function getStaticPaths() {
    const allPosts = await Astro.glob("../posts/*.md")
    const uniqueTags = [...new Set(allPosts.map((post: postType) => post.frontmatter.tags).flat())]

    return uniqueTags.map((tag: string)=> {
        var filteredPosts = allPosts.filter((post : postType) => post.frontmatter.tags?.includes(tag))
        return{
            params: {tag},
            props: {posts: filteredPosts}
        }
    })
}
const { tag } = Astro.params; 
const { posts } = Astro.props; 
const filteredPost = posts.filter(val => val.frontmatter.tags?.includes(tag))

---
<BaseLayout pageTitle={tag}>
  <p>Posts tagged with {tag}</p>
  <ul
      class = "[&>li]:my-5"
    >
      {filteredPost && filteredPost.length > 0 && 
          filteredPost.map(item => <li class = "hover:font-bold hover:underline">
                  <a href="{item.url}">{item.frontmatter.title}</a>
              </li>)
      }
  </ul>
</BaseLayout>